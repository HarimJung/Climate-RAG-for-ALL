import type { Metadata } from 'next';
import { VulnerabilityChart } from './chart';

export const metadata: Metadata = {
  title: 'Climate Vulnerability Comparison',
  description: 'ND-GAIN vulnerability and readiness scores, key risk factors, and adaptation capacity across 6 pilot countries.',
};

interface RiskProfile {
  iso3: string;
  country: string;
  risk_level: 'low' | 'medium' | 'high';
  vulnerability: number;
  readiness: number;
  vulnerabilityTrend: string;
  readinessTrend: string;
  co2PerCapita: number;
  renewablePct: number;
  pm25: number;
  forestPct: number;
  key_vulnerabilities: string[];
  strengths: string[];
  summary: string;
}

const profiles: RiskProfile[] = [
  {
    iso3: 'BGD', country: 'Bangladesh', risk_level: 'high',
    vulnerability: 0.5684, readiness: 0.2793,
    vulnerabilityTrend: 'worsening', readinessTrend: 'improving',
    co2PerCapita: 0.69, renewablePct: 1.62, pm25: 42.38, forestPct: 14.49,
    key_vulnerabilities: [
      'Extreme flood & sea-level rise risk (coastal lowland population exposure)',
      'Energy transition stalled (fossil fuel 98.4%, renewable 1.6%)',
      'Severe air pollution (PM2.5 42.4 ug/m3, 8x WHO guideline)',
    ],
    strengths: [
      'Carbon intensity improving (0.327 to 0.272 kg CO2/USD)',
      'Sustained GDP growth (+30% per capita)',
    ],
    summary: 'Most vulnerable among pilot countries (ND-GAIN 0.568). Sea-level rise, cyclones, and floods threaten coastal populations. Energy mix dominated by fossil fuels (98.4%).',
  },
  {
    iso3: 'NGA', country: 'Nigeria', risk_level: 'high',
    vulnerability: 0.4811, readiness: 0.2526,
    vulnerabilityTrend: 'stable', readinessTrend: 'improving',
    co2PerCapita: 0.55, renewablePct: 22.89, pm25: 56.53, forestPct: 23.21,
    key_vulnerabilities: [
      'Dual climate risk: Sahel desertification + southern delta flooding',
      'Worst air quality (PM2.5 56.5 ug/m3, 11x WHO guideline)',
      'Lowest adaptation readiness (ND-GAIN 0.25)',
    ],
    strengths: [
      'Lowest per-capita CO2 (0.55 mt)',
      'Hydropower base (22.9% renewable)',
    ],
    summary: 'High vulnerability (0.48) with lowest readiness (0.25). Dual risk from Sahel desertification and coastal flooding. Low emissions reflect energy poverty, not clean energy.',
  },
  {
    iso3: 'BRA', country: 'Brazil', risk_level: 'medium',
    vulnerability: 0.3685, readiness: 0.3505,
    vulnerabilityTrend: 'stable', readinessTrend: 'improving',
    co2PerCapita: 2.27, renewablePct: 89.00, pm25: 12.18, forestPct: 58.98,
    key_vulnerabilities: [
      'Ongoing deforestation (forest cover 59.7% to 59.0%)',
      'Amazon drought & rainfall pattern shifts',
      'Agricultural productivity threatened by warming',
    ],
    strengths: [
      'World-leading renewable electricity (89%, mainly hydro)',
      'Lowest grid carbon intensity (96.3 gCO2/kWh)',
    ],
    summary: 'Moderate vulnerability (0.37). World-leading renewables (89%) but ongoing Amazon deforestation undermines carbon sinks.',
  },
  {
    iso3: 'USA', country: 'United States', risk_level: 'medium',
    vulnerability: 0.312, readiness: 0.6473,
    vulnerabilityTrend: 'stable', readinessTrend: 'worsening',
    co2PerCapita: 13.71, renewablePct: 22.68, pm25: 7.81, forestPct: 33.87,
    key_vulnerabilities: [
      'Highest per-capita emissions (13.7 mt CO2, top among 6 countries)',
      'Wildfires, hurricanes, floods: diverse acute risks',
      'Readiness declining (0.666 to 0.647, policy instability)',
    ],
    strengths: [
      'Strong carbon intensity improvement (-32% since 2018)',
      'IRA-driven renewable growth (17.4% to 22.7%)',
    ],
    summary: 'Moderate vulnerability (0.31) with high adaptation capacity. Largest historical emitter with declining per-capita emissions.',
  },
  {
    iso3: 'DEU', country: 'Germany', risk_level: 'medium',
    vulnerability: 0.3015, readiness: 0.6816,
    vulnerabilityTrend: 'stable', readinessTrend: 'worsening',
    co2PerCapita: 7.08, renewablePct: 54.41, pm25: 10.29, forestPct: 32.68,
    key_vulnerabilities: [
      'Industrial decarbonization challenge (steel, chemicals, auto)',
      'Increasing heatwave & drought frequency',
      'Post-nuclear transition risk to grid stability',
    ],
    strengths: [
      'Renewable electricity at 54.4% (Energiewende)',
      'Lowest carbon intensity (0.129 kg CO2/USD)',
      'Second-highest adaptation readiness (0.68)',
    ],
    summary: 'Low vulnerability (0.30) with strong Energiewende results. 54% renewable electricity, lowest carbon intensity among pilot countries.',
  },
  {
    iso3: 'KOR', country: 'South Korea', risk_level: 'medium',
    vulnerability: 0.3567, readiness: 0.7223,
    vulnerabilityTrend: 'improving', readinessTrend: 'improving',
    co2PerCapita: 11.42, renewablePct: 9.57, pm25: 25.94, forestPct: 64.11,
    key_vulnerabilities: [
      'High fossil fuel dependency (61.2% of electricity)',
      'Lowest renewable share among pilot countries (9.6%)',
      'Severe PM2.5 pollution (25.9 ug/m3, lowest in OECD)',
    ],
    strengths: [
      'Highest adaptation readiness (ND-GAIN 0.72, #1 among 6)',
      'Decoupling progress (GDP growth with emission decline)',
    ],
    summary: 'Highest readiness (0.72) but lagging in energy transition. Only 9.6% renewable electricity, highest carbon intensity per GDP.',
  },
];

const riskColors = { low: 'text-emerald-400 bg-emerald-400/10 border-emerald-400/30', medium: 'text-amber-400 bg-amber-400/10 border-amber-400/30', high: 'text-red-400 bg-red-400/10 border-red-400/30' };
const trendIcons: Record<string, string> = { improving: '\u2191', worsening: '\u2193', stable: '\u2192' };
const trendColors: Record<string, string> = { improving: 'text-emerald-400', worsening: 'text-red-400', stable: 'text-slate-400' };

export default function ClimateVulnerabilityPage() {
  return (
    <div className="mx-auto max-w-5xl px-6 py-20">
      <div className="mb-12">
        <p className="text-sm text-emerald-400 font-medium">Climate Insights</p>
        <h1 className="mt-2 text-3xl font-bold tracking-tight md:text-4xl">
          Climate Vulnerability Comparison
        </h1>
        <p className="mt-3 text-slate-400">
          6 pilot countries &middot; ND-GAIN Index &middot; Risk profiles
        </p>
        <div className="mt-4 flex flex-wrap gap-2 text-xs text-slate-500">
          <span>Source: ND-GAIN, Climate TRACE, Ember, WDI</span>
          <span>&middot;</span>
          <span>Assessment date: Feb 2026</span>
        </div>
      </div>

      {/* Scatter plot */}
      <section className="rounded-xl border border-slate-800 bg-slate-900 p-6">
        <h2 className="mb-4 text-lg font-semibold">Vulnerability vs Readiness</h2>
        <VulnerabilityChart />
        <p className="mt-3 text-xs text-slate-500">
          X-axis: ND-GAIN Readiness (higher = more prepared). Y-axis: ND-GAIN Vulnerability (higher = more vulnerable).
        </p>
      </section>

      {/* Country Cards */}
      <section className="mt-10 space-y-6">
        {profiles.map((p) => (
          <div key={p.iso3} className="rounded-xl border border-slate-800 bg-slate-900 p-6">
            <div className="flex flex-wrap items-start justify-between gap-4">
              <div>
                <div className="flex items-center gap-3">
                  <h3 className="text-xl font-semibold">{p.country}</h3>
                  <span className={`rounded-full border px-3 py-0.5 text-xs font-medium ${riskColors[p.risk_level]}`}>
                    {p.risk_level.toUpperCase()}
                  </span>
                </div>
                <p className="mt-1 text-sm text-slate-400">{p.summary}</p>
              </div>
              <div className="flex gap-6 text-center">
                <div>
                  <p className="text-xs text-slate-500">Vulnerability</p>
                  <p className="font-mono text-lg font-bold text-amber-400">{p.vulnerability.toFixed(3)}</p>
                  <p className={`text-xs ${trendColors[p.vulnerabilityTrend]}`}>
                    {trendIcons[p.vulnerabilityTrend]} {p.vulnerabilityTrend}
                  </p>
                </div>
                <div>
                  <p className="text-xs text-slate-500">Readiness</p>
                  <p className="font-mono text-lg font-bold text-emerald-400">{p.readiness.toFixed(3)}</p>
                  <p className={`text-xs ${trendColors[p.readinessTrend]}`}>
                    {trendIcons[p.readinessTrend]} {p.readinessTrend}
                  </p>
                </div>
              </div>
            </div>

            {/* Indicator bars */}
            <div className="mt-5 grid gap-3 md:grid-cols-4">
              <div>
                <p className="text-xs text-slate-500">CO2/capita</p>
                <p className="font-mono text-sm font-medium">{p.co2PerCapita.toFixed(2)} mt</p>
              </div>
              <div>
                <p className="text-xs text-slate-500">Renewable %</p>
                <p className="font-mono text-sm font-medium">{p.renewablePct.toFixed(1)}%</p>
              </div>
              <div>
                <p className="text-xs text-slate-500">PM2.5</p>
                <p className="font-mono text-sm font-medium">{p.pm25.toFixed(1)} ug/m3</p>
              </div>
              <div>
                <p className="text-xs text-slate-500">Forest Cover</p>
                <p className="font-mono text-sm font-medium">{p.forestPct.toFixed(1)}%</p>
              </div>
            </div>

            {/* Vulnerabilities & Strengths */}
            <div className="mt-5 grid gap-4 md:grid-cols-2">
              <div>
                <p className="mb-2 text-xs font-semibold uppercase tracking-wider text-red-400">Key Vulnerabilities</p>
                <ul className="space-y-1 text-sm text-slate-400">
                  {p.key_vulnerabilities.map((v, i) => (
                    <li key={i} className="flex gap-2">
                      <span className="mt-0.5 shrink-0 text-red-500">&bull;</span>
                      {v}
                    </li>
                  ))}
                </ul>
              </div>
              <div>
                <p className="mb-2 text-xs font-semibold uppercase tracking-wider text-emerald-400">Strengths</p>
                <ul className="space-y-1 text-sm text-slate-400">
                  {p.strengths.map((s, i) => (
                    <li key={i} className="flex gap-2">
                      <span className="mt-0.5 shrink-0 text-emerald-500">&bull;</span>
                      {s}
                    </li>
                  ))}
                </ul>
              </div>
            </div>
          </div>
        ))}
      </section>
    </div>
  );
}
